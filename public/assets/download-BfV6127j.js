import{A as b}from"./index-DhY30Y_2.js";function $(a){if(/^https?:\/\//i.test(a))return a;const i=b.replace(/\/+$/,"");let o=a.startsWith("/")?a:`/${a}`;return/\/api$/i.test(i)&&/^\/api(\/|$)/i.test(o)&&(o=o.replace(/^\/api/i,""),o.startsWith("/")||(o=`/${o}`)),`${i}${o}`}async function U(a,i={},o="download"){const c=new URLSearchParams;Object.entries(i).forEach(([t,e])=>{e!=null&&e!==""&&c.set(t,e)});const r=localStorage.getItem("token"),l=$(a),m=c.toString()?`${l}?${c.toString()}`:l,n=await fetch(m,{method:"GET",headers:r?{Authorization:`Bearer ${r}`}:{}});if(!n.ok){let t=`Download failed (${n.status})`;try{const e=await n.json();e!=null&&e.message&&(t=e.message)}catch{}throw new Error(t)}const p=await n.blob();let d=o;const f=n.headers.get("content-disposition");if(f){const t=/filename\*=UTF-8''([^;]+)|filename="?([^";]+)"?/i.exec(f),e=decodeURIComponent((t==null?void 0:t[1])||(t==null?void 0:t[2])||"");e&&(d=e)}const h=URL.createObjectURL(p),s=document.createElement("a");s.href=h,s.download=d,document.body.appendChild(s),s.click(),s.remove(),URL.revokeObjectURL(h)}export{U as a};
